<!DOCTYPE html>
<html lang="he" dir="rtl">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>×”×¢×™×¨×™×™×”: ×”××“×™× ×” ×”×§×˜× ×” ×©×œ×š</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: #0f1117;
      color: #fff;
      min-height: 100vh;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .container { width: 100%; max-width: 1000px; }

    /* Nav */
    .nav {
      display: flex;
      gap: 12px;
      justify-content: center;
      margin-bottom: 22px;
    }
    .nav a {
      color: #7eb8f7;
      text-decoration: none;
      font-size: 0.9rem;
      font-weight: 600;
      padding: 8px 18px;
      border-radius: 8px;
      border: 1px solid #2a2f4e;
      background: #1a1f2e;
      transition: background .15s, border-color .15s;
    }
    .nav a:hover { background: #252b3b; border-color: #7eb8f7; }
    .nav a.active { background: #7eb8f7; color: #0f1117; border-color: #7eb8f7; }

    h1 { text-align: center; font-size: 1.8rem; margin-bottom: 6px; font-weight: 700; }
    .subtitle { text-align: center; color: #aaa; font-size: 0.95rem; margin-bottom: 24px; line-height: 1.6; }

    .analogy {
      background: linear-gradient(135deg, #1a1f2e, #252b3b);
      border: 1px solid #3a4060;
      border-radius: 12px;
      padding: 16px 24px;
      text-align: center;
      margin-bottom: 28px;
      font-size: 0.95rem;
      color: #ccd;
      line-height: 1.7;
    }
    .analogy strong { color: #7eb8f7; }

    .section {
      background: #1a1f2e;
      border-radius: 14px;
      padding: 18px 22px;
      border: 1px solid #2a2f4e;
      margin-bottom: 28px;
    }

    .section-title {
      font-size: 1rem;
      font-weight: 700;
      color: #aab;
      margin-bottom: 16px;
      padding-bottom: 8px;
      border-bottom: 1px solid #2a2f4e;
    }

    .section-note {
      font-size: 0.82rem;
      color: #778;
      margin-top: 12px;
      line-height: 1.5;
      text-align: center;
    }

    /* Treemap */
    #treemap { width: 100%; height: 380px; position: relative; border-radius: 8px; overflow: hidden; background: #12141c; }
    @media (max-width:600px) { #treemap { height: 480px; } }

    .tm-cell {
      position: absolute;
      border: 2px solid #0f1117;
      border-radius: 4px;
      cursor: pointer;
      transition: filter .15s;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      padding: 4px;
    }
    .tm-cell:hover { filter: brightness(1.3); z-index: 10; }
    .tm-label { font-size: clamp(.6rem, 1.3vw, .9rem); font-weight: 700; color: rgba(255,255,255,.95); text-shadow: 0 1px 3px rgba(0,0,0,.7); line-height: 1.3; }
    .tm-pct { font-size: clamp(.65rem, 1.4vw, .95rem); font-weight: 800; color: #fff; margin-top: 3px; }

    /* Tooltip */
    #tooltip {
      position: fixed; background: rgba(10,12,22,.97); border: 1px solid #4a5080; border-radius: 10px;
      padding: 12px 16px; font-size: .85rem; color: #dde; pointer-events: none; z-index: 1000;
      max-width: 260px; display: none; direction: rtl;
    }
    .tt-title { font-weight: 700; font-size: .95rem; margin-bottom: 6px; }
    .tt-row { display: flex; justify-content: space-between; gap: 16px; margin-top: 4px; font-size: .82rem; }
    .tt-val { color: #7eb8f7; font-weight: 600; }

    /* Expanded cell overlay */
    .tm-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 900; opacity: 0; transition: opacity .25s ease; cursor: pointer; display: none; }
    .tm-overlay.active { opacity: 1; }
    .tm-expanded {
      position: fixed; z-index: 950; border-radius: 16px; padding: 28px 24px; display: none;
      flex-direction: column; align-items: center; justify-content: center; text-align: center;
      max-width: 90vw; max-height: 85vh; width: 380px; top: 50%; left: 50%;
      transform: translate(-50%,-50%) scale(0.6); opacity: 0;
      transition: transform .3s cubic-bezier(.17,.67,.4,1.1), opacity .25s ease;
      pointer-events: none; box-shadow: 0 20px 60px rgba(0,0,0,0.6);
      border: 2px solid rgba(255,255,255,0.15); overflow-y: auto;
    }
    .tm-expanded.active { transform: translate(-50%,-50%) scale(1); opacity: 1; pointer-events: auto; }
    .tm-expanded .exp-close { position: absolute; top: 10px; left: 10px; width: 32px; height: 32px; border-radius: 50%; background: rgba(0,0,0,0.4); border: 1px solid rgba(255,255,255,0.2); color: #fff; font-size: 1.2rem; cursor: pointer; display: flex; align-items: center; justify-content: center; }
    .tm-expanded .exp-close:hover { background: rgba(0,0,0,0.7); }
    .tm-expanded .exp-name { font-size: 1.4rem; font-weight: 800; color: #fff; text-shadow: 0 2px 6px rgba(0,0,0,.5); margin-bottom: 4px; }
    .tm-expanded .exp-sub { font-size: 0.95rem; color: rgba(255,255,255,.75); margin-bottom: 12px; }
    .tm-expanded .exp-desc { font-size: 0.9rem; color: rgba(255,255,255,.85); line-height: 1.5; margin-bottom: 18px; padding: 0 8px; }
    .tm-expanded .exp-stats { width: 100%; display: flex; flex-direction: column; gap: 10px; }
    .tm-expanded .exp-stat-row { display: flex; justify-content: space-between; align-items: center; background: rgba(0,0,0,0.25); padding: 10px 16px; border-radius: 8px; font-size: 0.9rem; }
    .tm-expanded .exp-stat-label { color: rgba(255,255,255,.7); }
    .tm-expanded .exp-stat-val { font-weight: 700; color: #fff; font-size: 1rem; }
    @media (max-width:600px) { .tm-expanded { width: 92vw; padding: 22px 16px; } .tm-expanded .exp-name { font-size: 1.2rem; } }

    .legend { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; margin-top: 14px; }
    .leg-item { display: flex; align-items: center; gap: 6px; font-size: .78rem; color: #99a; }
    .leg-dot { width: 12px; height: 12px; border-radius: 3px; flex-shrink: 0; }

    /* Dual columns */
    .dual-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-top: 14px; }
    @media (max-width:600px) { .dual-grid { grid-template-columns: 1fr; } }

    .dual-card {
      background: #232840;
      border-radius: 10px;
      padding: 16px;
      border-top: 3px solid;
    }
    .dual-card-title { font-size: 0.95rem; font-weight: 700; margin-bottom: 10px; }
    .dual-card p { font-size: 0.85rem; color: #aab; line-height: 1.5; margin-bottom: 6px; }

    /* Data table */
    .data-table { width: 100%; border-collapse: collapse; margin-top: 12px; }
    .data-table th {
      text-align: right; padding: 10px 12px; font-size: 0.8rem; color: #99a;
      border-bottom: 1px solid #2a2f4e; font-weight: 600;
    }
    .data-table td {
      padding: 10px 12px; font-size: 0.88rem; border-bottom: 1px solid rgba(255,255,255,0.04);
    }
    .data-table tr:hover td { background: rgba(255,255,255,0.02); }
    .data-table .highlight-val { color: #7eb8f7; font-weight: 700; }

    /* Income comparison */
    .income-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 0; margin-top: 14px; border-radius: 10px; overflow: hidden; }
    @media (max-width:600px) { .income-grid { grid-template-columns: 1fr; } }
    .income-col { padding: 16px; }
    .income-col:first-child { background: rgba(16,185,129,0.08); }
    .income-col:last-child { background: rgba(239,68,68,0.08); }
    .income-col-title { font-size: 0.9rem; font-weight: 700; margin-bottom: 12px; text-align: center; }
    .income-row { display: flex; justify-content: space-between; padding: 6px 0; font-size: 0.85rem; }
    .income-row span:last-child { font-weight: 700; }

    /* Bomb section */
    .bomb-section {
      background: linear-gradient(135deg, #2a1520, #1a1f2e);
      border: 1px solid #7a3050;
    }
    .bomb-title {
      font-size: 1rem; font-weight: 700; color: #ff6688;
      margin-bottom: 16px; padding-bottom: 8px; border-bottom: 1px solid #5a2040;
    }
    .bomb-stat {
      display: flex; align-items: center; justify-content: center; gap: 16px;
      background: rgba(255,102,136,0.08); border-radius: 10px; padding: 18px; margin-bottom: 14px;
      flex-wrap: wrap;
    }
    .bomb-stat-num { font-size: 2rem; font-weight: 900; color: #ff6688; }
    .bomb-stat-label { font-size: 0.9rem; color: #ccd; }
    .bomb-compare { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 14px; }
    @media (max-width:600px) { .bomb-compare { grid-template-columns: 1fr; } }
    .bomb-card { background: rgba(0,0,0,0.2); border-radius: 8px; padding: 14px; text-align: center; }
    .bomb-card-val { font-size: 1.3rem; font-weight: 800; margin-bottom: 4px; }
    .bomb-card-lbl { font-size: 0.8rem; color: #aaa; }

    /* Building incentive */
    .build-visual {
      display: flex; justify-content: center; align-items: flex-end; gap: 30px;
      margin: 20px 0; padding: 20px; background: #12141c; border-radius: 10px;
    }
    .build-item { text-align: center; }
    .build-icon { font-size: 2.5rem; margin-bottom: 6px; display: block; }
    .build-label { font-size: 0.78rem; color: #aaa; }
    .build-val { font-size: 0.9rem; font-weight: 700; margin-top: 4px; }
    .build-arrow { font-size: 1.5rem; color: #ff6688; font-weight: 900; margin-bottom: 20px; }

    /* Paradox columns */
    .paradox-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-top: 14px; }
    @media (max-width:600px) { .paradox-grid { grid-template-columns: 1fr; } }
    .paradox-card { border-radius: 10px; padding: 18px; }
    .paradox-card.strong { background: rgba(16,185,129,0.1); border: 1px solid rgba(16,185,129,0.3); }
    .paradox-card.weak { background: rgba(239,68,68,0.1); border: 1px solid rgba(239,68,68,0.3); }
    .paradox-card h3 { font-size: 0.95rem; margin-bottom: 10px; }
    .paradox-card p { font-size: 0.82rem; color: #bbc; line-height: 1.5; margin-bottom: 6px; }

    /* Calculator */
    .calc-container { display: flex; flex-direction: column; gap: 16px; }
    .calc-input-row {
      display: flex; gap: 12px; align-items: center; justify-content: center;
      background: #232840; padding: 16px; border-radius: 10px;
    }
    .calc-input-row input {
      background: #0f1117; border: 1px solid #3a4060; color: #fff;
      padding: 10px 14px; border-radius: 6px; font-size: 1.1rem;
      width: 120px; text-align: center; font-weight: 700;
    }
    .calc-input-row label { font-weight: 600; color: #dde; }
    .slider-wrap { width: 100%; margin-top: 10px; }

    input[type="range"] {
      -webkit-appearance: none; appearance: none; width: 100%; height: 6px;
      background: #334155; border-radius: 3px; outline: none; margin: 15px 0;
    }
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none; appearance: none; width: 20px; height: 20px;
      background: #7eb8f7; border-radius: 50%; cursor: pointer;
      border: 2px solid #1a1f2e; box-shadow: 0 0 10px rgba(126,184,247,0.4);
    }
    input[type="range"]::-moz-range-thumb {
      width: 20px; height: 20px; background: #7eb8f7; border-radius: 50%;
      cursor: pointer; border: 2px solid #1a1f2e;
    }

    .muni-results { display: flex; flex-direction: column; gap: 8px; margin-top: 14px; }
    .muni-row {
      display: flex; justify-content: space-between; align-items: center;
      padding: 8px 12px; background: rgba(255,255,255,0.03); border-radius: 6px; font-size: 0.9rem;
    }
    .muni-row-bar-wrap { flex-grow: 1; margin: 0 15px; height: 6px; background: #0f1117; border-radius: 3px; overflow: hidden; }
    .muni-row-bar { height: 100%; border-radius: 3px; }
    .muni-row-val { font-weight: 700; min-width: 60px; text-align: left; }

    .footnote { text-align: center; font-size: .75rem; color: #556; margin-top: 10px; line-height: 1.5; }

    @media (max-width: 600px) {
      body { padding: 12px; }
      h1 { font-size: 1.5rem; }
      .subtitle { font-size: 0.85rem; }
      .analogy { padding: 12px 16px; font-size: 0.85rem; }
      .section { padding: 14px 16px; }
    }
  </style>
</head>

<body>
  <div class="container">
    <nav class="nav">
      <a href="index.html">×ª×§×¦×™×‘ ×”××“×™× ×”</a>
      <a href="municipality.html" class="active">×”×¢×™×¨×™×™×” ×©×œ×š</a>
    </nav>

    <h1>ğŸ™ï¸ ×”×¢×™×¨×™×™×” â€” ×”××“×™× ×” ×”×§×˜× ×” ×©×œ×š</h1>
    <div class="subtitle">××¢×‘×¨ ×œ××¡×™× ×œ××“×™× ×”, ×™×© ×¢×•×“ ×©×›×‘×” ×©××ª×” ××©×œ× ×™×©×™×¨×•×ª â€” ×•×‘×œ×™ ×œ×”×¦×‘×™×¢ ×¢×œ×™×” ×‘×‘×—×™×¨×•×ª ×”××¨×¦×™×•×ª</div>

    <!-- ×¡×§×©×Ÿ 1: ×× ×œ×•×’×™×” -->
    <div class="analogy">
      ğŸ’¡ ×× ×ª×§×¦×™×‘ ×”××“×™× ×” = ××©×›×•×¨×ª ×©×œ <strong>â‚ª10,000</strong> â†’<br>
      ×ª×§×¦×™×‘ ×”×¢×™×¨×™×™×” = ×¢×•×“ <strong>â‚ª1,500â€“2,500</strong> ×™×©×™×¨×•×ª ××”×›×™×¡ ×©×œ×š.<br>
      ×™×—×¡ ×‘×™×Ÿ ×”×ª×§×¦×™×‘×™×: ××“×™× ×” <strong>~â‚ª580 ××™×œ×™××¨×“</strong>, ×¨×©×•×™×•×ª ××§×•××™×•×ª <strong>~â‚ª90 ××™×œ×™××¨×“</strong> (×™×—×¡ 1:6).
    </div>

    <!-- ×¡×§×©×Ÿ 2: ××¤×ª ×¤×¨×•×¤×•×¨×¦×™×•×ª ×¢×™×¨×•× ×™×ª -->
    <div class="section">
      <div class="section-title">ğŸ—ºï¸ ×œ××Ÿ ×”×•×œ×š ×”×›×¡×£ ×©×œ ×”×¢×™×¨×™×™×” â€” ×¤×¨×•×¤×•×¨×¦×™×•×ª ×ª×§×¦×™×‘ ×¢×™×¨×•× ×™ ×˜×™×¤×•×¡×™</div>
      <div id="treemap"></div>
      <div class="legend" id="legend"></div>
      <div class="section-note">×—×œ×§ ××ª×§×¦×™×‘ ×”×—×™× ×•×š ×•×”×¨×•×•×—×” ××’×™×¢ ×™×©×™×¨×•×ª ×××©×¨×“×™ ×××©×œ×” â€” ×”×¢×™×¨×™×™×” ×¨×§ ×× ×”×œ×ª ××•×ª×•</div>
    </div>

    <!-- ×¡×§×©×Ÿ 3: ×××™×¤×” ××’×™×¢ ×”×›×¡×£ -->
    <div class="section">
      <div class="section-title">ğŸ’° ×××™×¤×” ××’×™×¢ ×”×›×¡×£ ×œ×¢×™×¨×™×™×”?</div>
      <div class="income-grid">
        <div class="income-col">
          <div class="income-col-title" style="color:#10b981;">×¨×©×•×ª ×—×–×§×” (×›××• ×ª"×)</div>
          <div class="income-row"><span>××¨× ×•× ×” (×¢×¡×§×™× + ××’×•×¨×™×)</span><span style="color:#10b981;">~55%</span></div>
          <div class="income-row"><span>×”×¢×‘×¨×•×ª ××”××“×™× ×”</span><span style="color:#10b981;">~30%</span></div>
          <div class="income-row"><span>××’×¨×•×ª, ×¨×™×©×™×•× ×•×ª, ×§× ×¡×•×ª</span><span style="color:#10b981;">~15%</span></div>
        </div>
        <div class="income-col">
          <div class="income-col-title" style="color:#ef4444;">×¨×©×•×ª ×—×œ×©×” (×¤×¨×™×¤×¨×™×”)</div>
          <div class="income-row"><span>××¨× ×•× ×” (×¢×¡×§×™× + ××’×•×¨×™×)</span><span style="color:#ef4444;">~35%</span></div>
          <div class="income-row"><span>×”×¢×‘×¨×•×ª ××”××“×™× ×”</span><span style="color:#ef4444;">~55%</span></div>
          <div class="income-row"><span>××’×¨×•×ª, ×¨×™×©×™×•× ×•×ª, ×§× ×¡×•×ª</span><span style="color:#ef4444;">~10%</span></div>
        </div>
      </div>
      <div class="analogy" style="margin-top:16px; margin-bottom:0;">
        ×¨×©×•×ª ×©××¦×œ×™×—×” ×œ×××Ÿ ××ª ×¢×¦××” ×œ×œ× ×”×¢×‘×¨×•×ª ××”××“×™× ×” â€” ×”×™× <strong>×¨×©×•×ª ×—×–×§×”</strong>.<br>
        ×¨×©×•×ª ×ª×œ×•×™×” ×‘×™×¨×•×©×œ×™× â€” ×”×™× <strong style="color:#ff6688;">×¨×©×•×ª ×©×‘×™×¨×”</strong>.
      </div>
    </div>

    <!-- ×¡×§×©×Ÿ 4: ××¨× ×•× ×” ×œ××’×•×¨×™× ×œ×¤×™ ×¢×™×¨ -->
    <div class="section">
      <div class="section-title">ğŸ  ××¨× ×•× ×” ×œ××’×•×¨×™×: ×›××” ××©×œ××™× ×œ×¤×™ ×¢×™×¨ (×“×™×¨×ª 80 ×"×¨)</div>
      <table class="data-table">
        <thead>
          <tr><th>×¢×™×¨</th><th>â‚ª/×©× ×”</th><th>â‚ª/×"×¨</th><th>×”×¢×¨×”</th></tr>
        </thead>
        <tbody>
          <tr><td>×ª×œ ××‘×™×‘</td><td class="highlight-val">â‚ª7,000â€“10,000</td><td>â‚ª60â€“80</td><td style="color:#778;">×××•×¦×¢ ×¢×™×¨×•× ×™</td></tr>
          <tr><td>×™×¨×•×©×œ×™×</td><td class="highlight-val">â‚ª5,000â€“8,000</td><td>â‚ª60â€“100</td><td style="color:#778;">××“×™×“×” "× ×˜×•-× ×˜×•"</td></tr>
          <tr><td>×—×™×¤×”</td><td class="highlight-val">â‚ª5,000â€“7,000</td><td>â‚ª60â€“90</td><td style="color:#778;"></td></tr>
          <tr><td>×‘××¨ ×©×‘×¢</td><td class="highlight-val">â‚ª3,500â€“5,000</td><td>â‚ª45â€“65</td><td style="color:#778;"></td></tr>
          <tr><td>×¨×©×•×ª ×¤×¨×™×¤×¨×™××œ×™×ª</td><td class="highlight-val">â‚ª2,500â€“4,000</td><td>â‚ª30â€“50</td><td style="color:#778;"></td></tr>
        </tbody>
      </table>
      <div class="section-note">
        ×©×™×˜×•×ª ×”××“×™×“×” ×©×•× ×•×ª ×‘×™×Ÿ ×¢×¨×™× (×‘×¨×•×˜×•, × ×˜×•, ×‘×¨×•×˜×•-×‘×¨×•×˜×•) â€” ××” ×©××§×©×” ×¢×œ ×”×©×•×•××” ×™×©×™×¨×”.<br>
        ×¢×“×›×•×Ÿ 2025: ×”××¨× ×•× ×” ×¢×•×œ×” <strong style="color:#ff6688;">5.29%</strong> â€” ×”×’×‘×•×” ×‘×™×•×ª×¨ ×××– ×©× ×ª 2000.
      </div>
    </div>

    <!-- ×¡×§×©×Ÿ 5: ×”×¤×¦×¦×” - ××¨× ×•× ×” ×¢×¡×§×™×ª ××•×œ ××’×•×¨×™× -->
    <div class="section bomb-section">
      <div class="bomb-title">ğŸ’¥ ××™ ×‘×××ª ××××Ÿ ××ª ×”×¢×™×¨ ×©×œ×š?</div>
      <div class="bomb-compare">
        <div class="bomb-card">
          <div class="bomb-card-val" style="color:#10b981;">~â‚ª70</div>
          <div class="bomb-card-lbl">××’×•×¨×™× â€” â‚ª/×"×¨/×©× ×” (×ª"×)</div>
        </div>
        <div class="bomb-card">
          <div class="bomb-card-val" style="color:#ff6688;">~â‚ª500â€“530</div>
          <div class="bomb-card-lbl">××©×¨×“×™× â€” â‚ª/×"×¨/×©× ×” (×ª"×)</div>
        </div>
        <div class="bomb-card">
          <div class="bomb-card-val" style="color:#ff6688;">~â‚ª700â€“900</div>
          <div class="bomb-card-lbl">××¡×—×¨/×§× ×™×•×Ÿ â€” â‚ª/×"×¨/×©× ×” (×ª"×)</div>
        </div>
        <div class="bomb-card">
          <div class="bomb-card-val" style="color:#f59e0b;">0</div>
          <div class="bomb-card-lbl">×–×›×•×ª ×”×¦×‘×¢×” ×©×œ ×¢×¡×§×™× ×‘×‘×—×™×¨×•×ª ××§×•××™×•×ª</div>
        </div>
      </div>
      <div class="dual-grid" style="margin-top:16px;">
        <div style="font-size:0.88rem; color:#bbc; line-height:1.6; padding:10px; background:rgba(0,0,0,0.2); border-radius:8px;">
          ×¢×¡×§×™× ×›××¢×˜ ×œ× ××§×‘×œ×™× ×©×™×¨×•×ª×™ ×¢×™×¨ â€” ××™×Ÿ ×œ×”× ×—×™× ×•×š, ×¨×•×•×—×”, ×ª×¨×‘×•×ª. ×”× ××©×œ××™× <strong style="color:#ff6688;">×¤×™ 5</strong> ×•×××× ×™× ××ª ×›×•×œ×.
        </div>
        <div style="font-size:0.88rem; color:#bbc; line-height:1.6; padding:10px; background:rgba(0,0,0,0.2); border-radius:8px;">
          ×œ×¢×¡×§×™× ××™×Ÿ ×–×›×•×ª ×”×¦×‘×¢×” ×‘×‘×—×™×¨×•×ª ×œ×¨×©×•×ª â€” ×œ×›×Ÿ <strong style="color:#ff6688;">××™×Ÿ ×œ×”× ×›×•×— ×¤×•×œ×™×˜×™</strong> ×œ××—×•×ª ×¢×œ ×”× ×˜×œ.
        </div>
      </div>
      <div class="bomb-stat" style="margin-top:16px;">
        <div>
          <div class="bomb-stat-label">×¢×¡×§×™× ××©×œ××™× ×™×•×ª×¨ ××¨× ×•× ×” ×œ×"×¨ ×××’×•×¨×™× <strong style="color:#ff6688;">×¤×™ 5 ×¢×“ ×¤×™ 7</strong></div>
        </div>
      </div>
    </div>

    <!-- ×¡×§×©×Ÿ 6: ×ª××¨×™×¥ ×”×‘× ×™×™×” ×”× ×¡×ª×¨ -->
    <div class="section">
      <div class="section-title">ğŸ—ï¸ ×œ××” ×¨××©×™ ×¢×¨×™× ×œ× ×¨×•×¦×™× ×©×ª×‘× ×• ×“×™×¨×•×ª</div>
      <div class="build-visual">
        <div class="build-item">
          <span class="build-icon">ğŸ </span>
          <div class="build-label">×©×›×•× ×ª ××’×•×¨×™×</div>
          <div class="build-val" style="color:#ef4444;">×”×¤×¡×“ ×œ×¢×™×¨×™×™×”</div>
          <div style="font-size:0.75rem; color:#778; margin-top:4px;">××¨× ×•× ×” × ××•×›×” + ×©×™×¨×•×ª×™× ×™×§×¨×™×</div>
        </div>
        <div class="build-arrow">â†</div>
        <div class="build-item">
          <span class="build-icon">ğŸ¢</span>
          <div class="build-label">××–×•×¨ ×ª×¢×©×™×™×”/××©×¨×“×™×</div>
          <div class="build-val" style="color:#10b981;">×¨×•×•×— ×œ×¢×™×¨×™×™×”</div>
          <div style="font-size:0.75rem; color:#778; margin-top:4px;">××¨× ×•× ×” ×’×‘×•×”×” + ×©×™×¨×•×ª×™× ××™× ×™××œ×™×™×</div>
        </div>
      </div>
      <p style="font-size:0.88rem; color:#bbc; line-height:1.6; text-align:center;">
        ×¨××© ×¢×™×¨ ×©×¦×¨×™×š ×œ×‘×—×•×¨ ×‘×™×Ÿ ××™×©×•×¨ ×©×›×•× ×ª ××’×•×¨×™× ×œ××™×©×•×¨ ××–×•×¨ ×ª×¢×©×™×™×” â€” <strong style="color:#ff6688;">×™×¢×“×™×£ ×ª××™×“ ×ª×¢×©×™×™×”</strong>.<br>
        ×–×” ××—×“ ×”×’×•×¨××™× ×”× ×¡×ª×¨×™× ×œ××©×‘×¨ ×”×“×™×•×¨ ×‘×™×©×¨××œ.
      </p>
      <div class="analogy" style="margin-top:14px; margin-bottom:0;">
        ğŸ½ï¸ ×× ×“×™×¨×” = ×œ×§×•×— ×©×¦×•×¨×š ×”×¨×‘×” ×•××©×œ× ××¢×˜ â€”<br>
        <strong>×”××¡×¢×“×” ×ª×¢×“×™×£ ×œ×¡×’×•×¨ ××ª ×”××•×œ× ×œ××™×¨×•×¢×™× ×¤×¨×˜×™×™×.</strong>
      </div>
    </div>

    <!-- ×¡×§×©×Ÿ 7: ×¤×¨×“×•×§×¡ ×”×¤×¨×™×¤×¨×™×” -->
    <div class="section">
      <div class="section-title">âš–ï¸ ×¢×™×¨ ×¢×©×™×¨×” ×’×•×‘×” ×¤×—×•×ª, ×¢×™×¨ ×¢× ×™×™×” ×’×•×‘×” ×™×•×ª×¨ â€” ×•× ×•×ª× ×ª ×¤×—×•×ª</div>
      <div class="paradox-grid">
        <div class="paradox-card strong">
          <h3 style="color:#10b981;">ğŸ™ï¸ ×¢×™×¨ ×¢×©×™×¨×” (×ª"×)</h3>
          <p>×‘×¡×™×¡ ×¢×¡×§×™ ×’×“×•×œ â†’ ×”×›× ×¡×•×ª ×’×‘×•×”×•×ª</p>
          <p>â†’ ××¨× ×•× ×” ×œ××’×•×¨×™× × ××•×›×” ×™×—×¡×™×ª</p>
          <p>â†’ <strong style="color:#10b981;">×©×™×¨×•×ª ×˜×•×‘</strong></p>
        </div>
        <div class="paradox-card weak">
          <h3 style="color:#ef4444;">ğŸšï¸ ×¢×™×¨ ×¢× ×™×™×” (×¤×¨×™×¤×¨×™×”)</h3>
          <p>×‘×¡×™×¡ ×¢×¡×§×™ ×§×˜×Ÿ â†’ ×”×›× ×¡×•×ª × ××•×›×•×ª</p>
          <p>â†’ ×ª×œ×•×ª ×‘×”×¢×‘×¨×•×ª ××”××“×™× ×”</p>
          <p>â†’ <strong style="color:#ef4444;">×©×™×¨×•×ª ×™×¨×•×“</strong></p>
        </div>
      </div>
      <div style="margin-top:16px; background:rgba(255,255,255,0.03); padding:15px; border-radius:8px; border-right:4px solid #f59e0b;">
        <div style="font-weight:700; color:#dde; margin-bottom:5px;">×™×¨×•×©×œ×™× â€” ××§×¨×” ×§×™×¦×•×Ÿ:</div>
        <div style="font-size:0.88rem; color:#aaa; line-height:1.6;">
          ×’×‘×™×™×” ×‘×¤×•×¢×œ â€” <strong style="color:#ff6688;">61.4% ×‘×œ×‘×“</strong> ××”×—×™×•×‘ ×”×¤×•×˜× ×¦×™××œ×™.<br>
          ×”× ×—×•×ª ××¨× ×•× ×” ×©×œ <strong style="color:#ff6688;">~â‚ª950 ××™×œ×™×•×Ÿ</strong>/×©× ×” (××•×¡×“×•×ª ×“×ª, ×¢××•×ª×•×ª, ×¡×•×¦×™×•-××§×•× ×•××™) â€” ×›××¢×˜ ×–×”×” ×œ"××¢× ×§ ×”×‘×™×¨×”" ×©×™×¨×•×©×œ×™× ××§×‘×œ×ª ××”××“×™× ×” (<strong>â‚ª942 ××™×œ×™×•×Ÿ</strong>).<br>
          <span style="color:#f59e0b;">×™×¨×•×©×œ×™× ××§×‘×œ×ª ××¢× ×§ ××™×•×—×“ ××”××“×™× ×” â€” ×•××—×–×™×¨×” ××•×ª×• ×›××¢×˜ ×‘××œ×•××• ×›×”× ×—×•×ª ××¨× ×•× ×”.</span>
        </div>
      </div>
    </div>

    <!-- ×¡×§×©×Ÿ 8: ×§×¨×Ÿ ×”××¨× ×•× ×” -->
    <div class="section">
      <div class="section-title">ğŸ”¥ ×”×××‘×§ ×”×¤×•×œ×™×˜×™ ×¢×œ ×›×¡×¤×™ ×”××¨× ×•× ×”</div>
      <p style="font-size:0.9rem; color:#bbc; line-height:1.7;">
        ×”×××©×œ×” × ×™×¡×ª×” ×œ×”×§×™× <strong>"×§×¨×Ÿ ××¨× ×•× ×”"</strong> ×©×ª×¢×‘×™×¨ ×—×œ×§ ××”×›× ×¡×•×ª ×”××¨× ×•× ×” ×”×¢×¡×§×™×ª ××¨×©×•×™×•×ª ×¢×©×™×¨×•×ª ×œ×—×œ×©×•×ª.
        ×ª"× ×•×¨×©×•×™×•×ª ×—×–×§×•×ª ××—×¨×•×ª <strong style="color:#ff6688;">×”×ª× ×’×“×• ×‘×—×¨×™×¤×•×ª</strong> â€” ×›×™ ×–×” ×”×™×” ×œ×•×§×— ××”× ××ª ×”"×¤×¨×” ×”×—×•×œ×‘×ª" ×©×œ×”×.
      </p>
      <div class="analogy" style="margin-top:14px; margin-bottom:0;">
        ×”×¦×¢×” ×–×• ×××—×™×©×” ××ª ×”×¤×¨×“×•×§×¡: <strong>××™ ×©×™×© ×œ×• ×¢×¡×§×™× â€” ×©×•××¨ ×¢×œ ×”×›×¡×£</strong>.<br>
        ××™ ×©××™×Ÿ ×œ×• â€” <strong style="color:#ff6688;">×ª×œ×•×™ ×‘×˜×•×‘ ×œ×™×‘× ×©×œ ×”××—×¨×™×</strong>.
      </div>
    </div>

    <!-- ×¡×§×©×Ÿ 9: ××—×©×‘×•×Ÿ ××™×©×™ -->
    <div class="section">
      <div class="section-title">ğŸ§® ×”××—×©×‘×•×Ÿ ×©×œ×š â€” ×œ××Ÿ ×”×•×œ×›×ª ×”××¨× ×•× ×” ×©××ª×” ××©×œ×?</div>
      <div class="calc-container">
        <div class="calc-input-row">
          <label>××¨× ×•× ×” ×©× ×ª×™×ª ×‘-â‚ª:</label>
          <input type="number" id="muniInput" value="6000" step="500" min="0" max="50000"
            oninput="updateMuniCalc()">
        </div>
        <div class="slider-wrap" style="max-width:500px; width:100%; margin:0 auto;">
          <input type="range" id="muniSlider" min="0" max="20000" step="250" value="6000"
            oninput="document.getElementById('muniInput').value=this.value; updateMuniCalc();">
          <div style="display:flex; justify-content:space-between; font-size:0.75rem; color:#667;">
            <span>â‚ª0</span>
            <span>â‚ª20,000</span>
          </div>
        </div>
        <div id="muniResults" class="muni-results"></div>
        <div class="section-note">×”× ×ª×•× ×™× ××™× ×“×™×§×˜×™×‘×™×™× ×œ×¤×™ ×××•×¦×¢ ××¨×¦×™ â€” ×‘×¢×™×¨×š ×”×¡×¤×¦×™×¤×™×ª ×”×—×œ×•×§×” ×¢×©×•×™×” ×œ×”×™×•×ª ×©×•× ×”</div>
      </div>
    </div>

    <div class="footnote">
      * ××‘×•×¡×¡ ×¢×œ × ×ª×•× ×™ ×œ×"×¡, ××‘×§×¨ ×”××“×™× ×” ×•×¤×¨×¡×•××™× ×›×œ×›×œ×™×™× 2022â€“2025. ×—×œ×§ ××”× ×ª×•× ×™× ×”× ×××•×¦×¢×™× ×œ×¦×¨×›×™ ×”××—×©×”.
    </div>
  </div>

  <div id="tooltip"></div>
  <div class="tm-overlay" id="tmOverlay" onclick="closeExpanded()"></div>
  <div class="tm-expanded" id="tmExpanded"></div>

  <script>
    // === Municipal budget data ===
    const MUNI_TOTAL = 100;
    const muniCats = [
      { name: "×©×›×¨ ×¢×•×‘×“×™×", sub: "(×”× ×˜×œ ×”×’×“×•×œ)", v: 40, c: "#ef4444", d: "××©×›×•×¨×•×ª ×¢×•×‘×“×™ ×”×¢×™×¨×™×™×” â€” ××™× ×”×œ, ×¤×™×§×•×—, ×©×™×¨×•×ª×™×" },
      { name: "×—×™× ×•×š ××§×•××™", sub: "(×’× ×™×, ××—×”\"×¦, ×”×¢×©×¨×”)", v: 20, c: "#3b82f6", d: "×’× ×™ ×™×œ×“×™×, ×—×•×’×™ ××—×¨ ×”×¦×”×¨×™×™×, ×”×¢×©×¨×” â€” ×œ× ×©×›×¨ ××•×¨×™×" },
      { name: "×ª×©×ª×™×•×ª ×•× ×™×§×™×•×Ÿ", sub: "(×›×‘×™×©×™×, ××©×¤×”, ×ª××•×¨×”)", v: 15, c: "#10b981", d: "×¡×œ×™×œ×ª ×›×‘×™×©×™×, ×¤×™× ×•×™ ××©×¤×”, ×ª××•×¨×ª ×¨×—×•×‘, ×ª×—×–×•×§×”" },
      { name: "×¨×•×•×—×” ××§×•××™×ª", sub: "(×¡×™×•×¢ ×¡×•×¦×™××œ×™)", v: 10, c: "#f59e0b", d: "××—×œ×§×•×ª ×¡×•×¦×™××œ×™×•×ª, ×¡×™×•×¢ ×œ×§×©×™×©×™× ×•××©×¤×—×•×ª" },
      { name: "×ª×¨×‘×•×ª ×•×¡×¤×•×¨×˜", sub: "(×¡×¤×¨×™×•×ª, ××¨×›×–×™ ×§×”×™×œ×”)", v: 5, c: "#8b5cf6", d: "×¡×¤×¨×™×•×ª, ××ª× \"×¡×™×, ××™×¨×•×¢×™ ×ª×¨×‘×•×ª, ××’×¨×©×™ ×¡×¤×•×¨×˜" },
      { name: "××—×¨ ×•×¨×–×¨×‘×•×ª", sub: "(×©×•× ×•×ª)", v: 10, c: "#6b7280", d: "×”×•×¦××•×ª ×©×•× ×•×ª, ×¨×–×¨×‘×•×ª ×•×¤×¨×•×™×§×˜×™× ××™×•×—×“×™×" },
    ];

    // === Squarify algorithm ===
    function squarify(items, x, y, w, h) {
      const cells = [];
      let rem = [...items].sort((a, b) => b.v - a.v);
      let cx = x, cy = y, cw = w, ch = h;
      const tot = rem.reduce((s, i) => s + i.v, 0);
      while (rem.length) {
        const side = Math.min(cw, ch);
        let row = [], rs = 0;
        for (let i = 0; i < rem.length; i++) {
          const cand = [...row, rem[i]], cs = rs + rem[i].v;
          const candAreas = cand.map(v => (v.v / tot) * (w * h));
          if (!row.length || worstArea(candAreas, side) <= worstArea(row.map(v => (v.v / tot) * (w * h)), side)) {
            row = cand; rs = cs;
          } else break;
        }
        rem = rem.slice(row.length);
        const areaSum = (rs / tot) * (w * h);
        if (cw >= ch) {
          const rw = areaSum / ch; let ry = cy;
          row.forEach(it => { const rh = ((it.v / tot) * (w * h)) / rw; cells.push({ ...it, x: cx, y: ry, w: rw, h: rh }); ry += rh; });
          cx += rw; cw -= rw;
        } else {
          const rh = areaSum / cw; let rx = cx;
          row.forEach(it => { const rw2 = ((it.v / tot) * (w * h)) / rh; cells.push({ ...it, x: rx, y: cy, w: rw2, h: rh }); rx += rw2; });
          cy += rh; ch -= rh;
        }
      }
      return cells;
    }

    function worstArea(rowAreas, side) {
      if (!rowAreas.length) return Infinity;
      const s = rowAreas.reduce((a, b) => a + b, 0);
      const mx = Math.max(...rowAreas);
      const mn = Math.min(...rowAreas);
      return Math.max((side * side * mx) / (s * s), (s * s) / (side * side * mn));
    }

    // === Treemap render ===
    function renderTreemap() {
      const el = document.getElementById('treemap');
      const W = el.offsetWidth, H = el.offsetHeight;
      const cells = squarify(muniCats, 0, 0, W, H);
      el.innerHTML = '';
      cells.forEach(cell => {
        const pct = cell.v + '%';
        const d = document.createElement('div');
        d.className = 'tm-cell';
        d.style.cssText = `left:${cell.x}px;top:${cell.y}px;width:${cell.w}px;height:${cell.h}px;background:${cell.c};`;
        if (cell.w > 50 && cell.h > 34) {
          d.innerHTML = `<div class="tm-label">${cell.name}<br><span style="font-weight:400;font-size:.85em;opacity:.85">${cell.sub}</span></div><div class="tm-pct">${pct}</div>`;
        }
        d.addEventListener('mouseenter', e => showTT(e, cell));
        d.addEventListener('mousemove', e => moveTT(e));
        d.addEventListener('mouseleave', hideTT);
        d.addEventListener('click', () => openExpanded(cell));
        el.appendChild(d);
      });
      document.getElementById('legend').innerHTML = muniCats.map(c =>
        `<div class="leg-item"><div class="leg-dot" style="background:${c.c}"></div>${c.name}</div>`
      ).join('');
    }

    // === Tooltip ===
    function showTT(e, cell) {
      const tt = document.getElementById('tooltip');
      tt.innerHTML = `<div class="tt-title">${cell.name} ${cell.sub}</div>
        <div class="tt-row"><span style="color:#99a;font-size:.78rem">${cell.d}</span></div>
        <div class="tt-row"><span>×—×œ×§ ××”×ª×§×¦×™×‘:</span><span class="tt-val">${cell.v}%</span></div>`;
      tt.style.display = 'block'; moveTT(e);
    }
    function moveTT(e) {
      const tt = document.getElementById('tooltip');
      tt.style.left = (e.clientX + 14) + 'px'; tt.style.top = (e.clientY - 10) + 'px';
    }
    function hideTT() { document.getElementById('tooltip').style.display = 'none'; }

    // === Expanded view ===
    function openExpanded(cell) {
      hideTT();
      const overlay = document.getElementById('tmOverlay');
      const exp = document.getElementById('tmExpanded');
      exp.style.background = `linear-gradient(135deg, ${cell.c}, ${cell.c}dd)`;
      exp.innerHTML = `
        <button class="exp-close" onclick="closeExpanded()">&times;</button>
        <div class="exp-name">${cell.name}</div>
        <div class="exp-sub">${cell.sub}</div>
        <div class="exp-desc">${cell.d}</div>
        <div class="exp-stats">
          <div class="exp-stat-row"><span class="exp-stat-label">×—×œ×§ ××”×ª×§×¦×™×‘</span><span class="exp-stat-val">${cell.v}%</span></div>
          <div class="exp-stat-row"><span class="exp-stat-label">××ª×•×š ××¨× ×•× ×” ×©×œ â‚ª6,000/×©× ×”</span><span class="exp-stat-val">â‚ª${(6000 * cell.v / 100).toLocaleString()}</span></div>
        </div>`;
      overlay.style.display = 'block'; exp.style.display = 'flex';
      requestAnimationFrame(() => { overlay.classList.add('active'); exp.classList.add('active'); });
    }
    function closeExpanded() {
      const overlay = document.getElementById('tmOverlay');
      const exp = document.getElementById('tmExpanded');
      overlay.classList.remove('active'); exp.classList.remove('active');
      setTimeout(() => { overlay.style.display = 'none'; exp.style.display = 'none'; }, 300);
    }

    // === Municipal calculator ===
    const muniBreakdown = [
      { name: "×©×›×¨ ×¢×•×‘×“×™ ×”×¢×™×¨×™×™×”", pct: 40, c: "#ef4444" },
      { name: "×—×™× ×•×š ××§×•××™ (×’× ×™×, ××—×”\"×¦)", pct: 20, c: "#3b82f6" },
      { name: "×¤×™× ×•×™ ××©×¤×” ×•× ×™×§×™×•×Ÿ", pct: 8, c: "#10b981" },
      { name: "×ª×©×ª×™×•×ª (×›×‘×™×©×™×, ×ª××•×¨×”)", pct: 7, c: "#34d399" },
      { name: "×¨×•×•×—×” ×•×¡×•×¦×™××œ×™", pct: 10, c: "#f59e0b" },
      { name: "×ª×¨×‘×•×ª ×•×¡×¤×•×¨×˜", pct: 5, c: "#8b5cf6" },
      { name: "××—×¨", pct: 10, c: "#6b7280" },
    ];

    function updateMuniCalc() {
      const annual = parseFloat(document.getElementById('muniInput').value) || 0;
      document.getElementById('muniSlider').value = annual;
      const res = document.getElementById('muniResults');
      const maxPct = Math.max(...muniBreakdown.map(b => b.pct));
      res.innerHTML = muniBreakdown.map(b => {
        const amount = annual * b.pct / 100;
        const barW = (b.pct / maxPct * 100).toFixed(1);
        return `<div class="muni-row">
          <div style="width:180px; font-weight:600;">${b.name}</div>
          <div class="muni-row-bar-wrap"><div class="muni-row-bar" style="width:${barW}%; background:${b.c}"></div></div>
          <div class="muni-row-val" style="color:${b.c};">â‚ª${amount.toLocaleString(undefined, {maximumFractionDigits:0})}</div>
        </div>`;
      }).join('');
    }

    window.addEventListener('load', () => { renderTreemap(); updateMuniCalc(); });
    window.addEventListener('resize', renderTreemap);
    window.addEventListener('keydown', e => { if (e.key === 'Escape') closeExpanded(); });
  </script>
</body>
</html>
